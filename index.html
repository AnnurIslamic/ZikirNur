<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZikirNur</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
    <style>
        /* --- Global Reset & Box Sizing --- */
        *,
        *::before,
        *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        :root {
            --primary-color: #00796B; /* Teal */
            --secondary-color: #4CAF50; /* Green */
            --accent-color: #FFC107; /* Amber for highlight */
            --bg-color-light: #F0F4F8; /* Light blue-grey */
            --text-color-light: #2C3E50; /* Darker text */
            --card-bg-light: #FFFFFF;
            --dark-green: #004D40;
            --border-color-light: #E0E0E0;
            --icon-color-light: #7F8C8D; /* Greyish icon */
            --bg-color: var(--bg-color-light);
            --text-color: var(--text-color-light);
            --card-bg: var(--card-bg-light);
            --border-color: var(--border-color-light);
            --icon-color: var(--icon-color-light);
        }

        .dark-mode {
            --primary-color: #66BB6A;
            --secondary-color: #81C784;
            --accent-color: #FFD54F;
            --bg-color: #1A202C;
            --text-color: #E0E0E0;
            --card-bg: #2D3748;
            --border-color: #4A5568;
            --icon-color: #A0AEC0;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            transition: background-color 0.3s ease, color 0.3s ease;
            line-height: 1.6;
        }

        main {
            width: 100%;
            max-width: 800px;
            padding: 1.5rem;
            margin: 0 auto;
        }

        .content-section {
            display: none;
            padding-top: 1rem;
        }
        .content-section.active { display: block; }

        h2 {
            font-family: 'Playfair Display', serif;
            font-size: 2.2rem;
            text-align: center;
            color: var(--primary-color);
            margin-bottom: 2.5rem;
            position: relative;
        }
        h2::after {
            content: '';
            position: absolute;
            left: 50%;
            bottom: -10px;
            transform: translateX(-50%);
            width: 60px;
            height: 3px;
            background-color: var(--accent-color);
            border-radius: 2px;
        }
        .dark-mode h2 { color: var(--primary-color); }

        .top-bar {
            background-color: var(--primary-color);
            color: white;
            padding: 1rem 1.5rem;
            display: flex;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        
        /* [PERBAIKAN] Utility class untuk tombol ikon agar aksesibel */
        .icon-btn {
            background: none;
            border: none;
            color: inherit;
            cursor: pointer;
            padding: 0;
            font-size: 1.8rem;
            transition: transform 0.2s ease;
        }
        .icon-btn:hover { transform: scale(1.1); }

        .menu-icon-btn {
            margin-right: 1rem;
        }
        
        .top-bar-title {
            font-family: 'Playfair Display', serif;
            font-size: 1.8rem;
            font-weight: 700;
        }

        .overlay {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            z-index: 999;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.4s ease, visibility 0.4s ease;
            backdrop-filter: blur(2px);
        }
        .overlay.active { opacity: 1; visibility: visible; }

        .sidebar {
            height: 100%;
            width: 280px;
            position: fixed;
            z-index: 1001;
            top: 0; left: 0;
            background-color: var(--card-bg);
            overflow-x: hidden;
            transition: transform 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            box-shadow: 4px 0 15px rgba(0,0,0,0.2);
            color: var(--text-color);
            display: flex;
            flex-direction: column;
            transform: translateX(-100%);
        }
        .sidebar.active { transform: translateX(0); }

        .sidebar .header-title {
            font-family: 'Playfair Display', serif;
            font-size: 1.9rem;
            font-weight: 700;
            color: var(--primary-color);
            padding: 1.5rem;
            margin-bottom: 1rem;
            border-bottom: 1px solid var(--border-color);
        }

        .sidebar-nav-list { list-style: none; }
        .sidebar-nav-list a {
            padding: 1rem 1.5rem;
            text-decoration: none;
            font-size: 1.1rem;
            color: var(--text-color);
            display: flex;
            align-items: center;
            gap: 1rem;
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        .sidebar-nav-list a i {
            width: 24px;
            text-align: center;
            color: var(--icon-color);
        }
        .sidebar-nav-list a:hover,
        .sidebar-nav-list a.current-page {
            background-color: var(--bg-color-light);
            color: var(--primary-color);
            font-weight: 600;
        }
        .dark-mode .sidebar-nav-list a:hover,
        .dark-mode .sidebar-nav-list a.current-page {
             background-color: #3B4455;
             color: var(--primary-color);
        }
        .sidebar-nav-list a:hover i,
        .sidebar-nav-list a.current-page i { color: var(--primary-color); }

        #dashboard-section { padding-top: 0; }
        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }
        .dashboard-header h3 {
            font-family: 'Poppins', sans-serif;
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--text-color);
        }
        .dashboard-header p {
            font-size: 0.9rem;
            color: var(--icon-color);
        }
        .dashboard-header .info-icon-btn,
        .dashboard-header .moon-icon-btn {
            font-size: 1.3rem;
            color: var(--icon-color);
        }
        .dashboard-header .info-icon-btn:hover { color: var(--accent-color); }
        .dashboard-header .moon-icon-btn.dark-mode-active { color: var(--primary-color); }
        .dashboard-header .icon-group {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .prayer-time-card {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--dark-green) 100%);
            color: white;
            border-radius: 20px;
            padding: 1.8rem 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
            position: relative;
            overflow: hidden;
        }
        .prayer-time-card::before {
            content: '';
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: url('data:image/svg+xml;utf8,<svg width="100" height="100" viewBox="0 0 100" xmlns="http://www.w3.org/2000/svg"><path d="M 50 0 L 100 50 L 50 100 L 0 50 Z" fill="%23FFFFFF" opacity="0.05"/></svg>') repeat;
            background-size: 80px;
            opacity: 0.1;
            z-index: 0;
        }
        .prayer-time-card > * { position: relative; z-index: 1; }
        .card-location {
            font-size: 1rem;
            font-weight: 500;
            margin-bottom: 0.5rem;
            opacity: 0.9;
        }
        .card-date {
            font-size: 0.9rem;
            opacity: 0.8;
            margin-bottom: 1.5rem;
        }
        .prayer-times-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
            gap: 1rem;
            text-align: center;
        }
        .prayer-time-item {
            background-color: rgba(255, 255, 255, 0.15);
            border-radius: 12px;
            padding: 0.8rem 0.5rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 0.3rem;
            transition: background-color 0.2s ease, transform 0.2s ease;
        }
        .prayer-time-item.next-prayer {
            background-color: var(--accent-color);
            color: #333;
            font-weight: 700;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            transform: translateY(-3px);
        }
        .prayer-time-item.next-prayer span,
        .prayer-time-item.next-prayer strong { color: #333; }
        .prayer-time-item span { font-size: 0.85rem; font-weight: 500; }
        .prayer-time-item strong {
            font-family: 'Poppins', sans-serif;
            font-size: 1.2rem;
            font-weight: 700;
            letter-spacing: -0.5px;
        }

        .featured-zikir-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-bottom: 2rem;
        }
        .zikir-card {
            background-color: var(--card-bg);
            padding: 1.8rem 1rem;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: relative;
        }
        .zikir-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
        }
        .zikir-card > i { /* Use > to target only the main icon */
            font-size: 3rem;
            margin-bottom: 1rem;
            transition: color 0.2s ease;
        }
        .zikir-card.pagi > i { color: #FDD835; }
        .zikir-card.petang > i { color: #7986CB; }
        .zikir-card h4 {
            font-family: 'Poppins', sans-serif;
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--text-color);
        }
        .zikir-card p.subtitle {
            font-size: 0.85rem;
            color: var(--icon-color);
            margin-top: 0.5rem;
            margin-bottom: 1.5rem;
        }
        
        .audio-controls-container {
            display: flex;
            gap: 1rem;
            justify-content: center;
            align-items: center;
        }

        .audio-btn {
            width: 45px;
            height: 45px;
            background-color: var(--primary-color);
            border: none;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            font-size: 1.1rem;
            cursor: pointer;
            transition: background-color 0.2s ease, transform 0.2s ease;
            box-shadow: 0 2px 5px rgba(0,0,0,0.15);
        }
        .audio-btn:hover {
            background-color: var(--secondary-color);
            transform: scale(1.1);
        }
        .audio-btn.stop-btn {
            background-color: #E53935; /* Warna merah untuk stop */
        }
        .audio-btn.stop-btn:hover {
            background-color: #C62828;
        }
        .hidden {
            display: none;
        }

        .shortcut-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 1.2rem;
            margin-top: 2rem;
        }
        .shortcut-item {
            background-color: var(--card-bg);
            border-radius: 15px;
            padding: 1.2rem 0.5rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 0.8rem;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            cursor: pointer;
            text-decoration: none;
            color: var(--text-color);
            text-align: center;
        }
        .shortcut-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        .shortcut-icon {
            font-size: 2rem;
            color: var(--primary-color);
            transition: color 0.2s ease;
        }
        .shortcut-item:hover .shortcut-icon { color: var(--secondary-color); }
        .shortcut-item span {
            font-size: 0.8rem;
            color: var(--text-color);
            font-weight: 500;
            line-height: 1.3;
        }
        
        /* [PERBAIKAN] Menambahkan style focus untuk aksesibilitas */
        .icon-btn:focus-visible, .audio-btn:focus-visible, .shortcut-item:focus-visible, .survey-button:focus-visible, .settings-item a:focus-visible, .store-button:focus-visible, .switch input:focus-visible + .slider {
            outline: 3px solid var(--accent-color);
            outline-offset: 3px;
            box-shadow: 0 0 10px rgba(255, 193, 7, 0.5);
        }

        .survey-button {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.8rem;
            background-color: var(--accent-color);
            color: #333;
            text-align: center;
            padding: 1.2rem 1rem;
            border-radius: 15px;
            font-weight: 700;
            text-decoration: none;
            margin-top: 2.5rem;
            box-shadow: 0 6px 15px rgba(255, 193, 7, 0.4);
            transition: background-color 0.2s ease, transform 0.2s ease, box-shadow 0.2s ease;
            font-size: 1.1rem;
        }
        .survey-button:hover {
            background-color: #FFB300;
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(255, 193, 7, 0.5);
        }
        .survey-button i { font-size: 1.3rem; }

        .settings-container, .explanation-container { padding: 0 0.5rem; }
        .settings-list {
            list-style: none;
            margin: 0 0 2rem 0;
            background-color: var(--card-bg);
            border-radius: 15px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            overflow: hidden;
        }
        .settings-list-title {
            font-family: 'Poppins', sans-serif;
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--primary-color);
            padding: 1.5rem 1.5rem 0.8rem;
        }
        .settings-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.2rem 1.5rem;
            border-bottom: 1px solid var(--border-color);
        }
        .settings-item:last-child { border-bottom: none; }
        .settings-item .setting-label { font-size: 1.1rem; font-weight: 500; }
        .settings-item .setting-value { font-size: 1rem; color: var(--icon-color); }
        .dark-mode .settings-item .setting-value { color: #bbb; }
        .settings-item a {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            text-decoration: none;
            color: inherit;
        }
        .settings-item .chevron-icon { color: var(--icon-color); margin-left: 1rem; font-size: 1rem; }
        .mode-toggle-container { display: flex; align-items: center; gap: 1rem; }
        .mode-toggle-container span { font-size: 1rem; font-weight: 500; }
        .mode-toggle-container .switch { position: relative; display: inline-block; width: 48px; height: 28px; }
        .mode-toggle-container .switch input { opacity: 0; width: 0; height: 0; }
        .mode-toggle-container .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 28px; }
        .dark-mode .mode-toggle-container .slider { background-color: #555; }
        .mode-toggle-container .slider:before { position: absolute; content: ""; height: 20px; width: 20px; left: 4px; bottom: 4px; background-color: white; transition: .4s; border-radius: 50%; }
        .mode-toggle-container input:checked + .slider { background-color: var(--primary-color); }
        .mode-toggle-container input:checked + .slider:before { transform: translateX(20px); }
        .store-button { display: block; margin-top: 2rem; padding: 1rem; background-color: black; color: white; text-align: center; border-radius: 12px; text-decoration: none; font-weight: 600; transition: background-color 0.2s ease; }
        .store-button:hover { background-color: #222; }
        .store-button i { margin-right: 0.5rem; }

        footer { text-align: center; padding: 1.5rem; background-color: var(--primary-color); color: white; margin-top: 3.5rem; box-shadow: 0 -2px 10px rgba(0,0,0,0.1); }
        
        /* [PENAMBAHAN BARU] Styling untuk Pop-up Kustom */
        .popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(4px);
            z-index: 2000;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 1rem;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        .popup-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        .popup-content {
            background-color: var(--card-bg);
            color: var(--text-color);
            padding: 2rem;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            max-width: 400px;
            width: 100%;
            text-align: center;
            transform: scale(0.9);
            opacity: 0;
            transition: transform 0.3s cubic-bezier(0.18, 0.89, 0.32, 1.28), opacity 0.3s ease;
        }
        .popup-overlay.active .popup-content {
            transform: scale(1);
            opacity: 1;
        }
        .popup-icon {
            font-size: 3.5rem;
            color: var(--primary-color);
            margin-bottom: 1rem;
        }
        .popup-title {
            font-family: 'Playfair Display', serif;
            font-size: 1.8rem;
            margin-bottom: 0.8rem;
            color: var(--text-color);
        }
        .popup-message {
            font-size: 1rem;
            line-height: 1.6;
            margin-bottom: 2rem;
            color: var(--icon-color);
        }
        .popup-actions {
            display: flex;
            gap: 1rem;
            justify-content: center;
        }
        .popup-btn {
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 12px;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.2s ease;
            flex-grow: 1;
        }
        .popup-btn.primary {
            background-color: var(--primary-color);
            color: white;
        }
        .popup-btn.primary:hover {
            background-color: var(--secondary-color);
            transform: translateY(-2px);
        }
        .popup-btn.secondary {
            background-color: transparent;
            color: var(--text-color);
            border: 2px solid var(--border-color);
        }
        .dark-mode .popup-btn.secondary {
             color: var(--text-color);
        }
        .popup-btn.secondary:hover {
            background-color: var(--border-color);
        }

        @media (max-width: 768px) {
            .top-bar-title, .sidebar .header-title { font-size: 1.6rem; }
            h2 { font-size: 1.8rem; }
            .prayer-times-grid { grid-template-columns: repeat(3, 1fr); gap: 0.8rem; }
            .featured-zikir-container { grid-template-columns: 1fr; }
        }
        @media (max-width: 480px) {
            main { padding: 1rem; }
            .sidebar { width: 250px; }
            .top-bar-title, .sidebar .header-title { font-size: 1.4rem; }
            h2 { font-size: 1.6rem; }
            .prayer-time-card { padding: 1.5rem 1rem; }
            .prayer-times-grid { grid-template-columns: repeat(2, 1fr); }
            .prayer-time-item strong { font-size: 1.1rem; }
            .zikir-card { padding: 1.5rem 1rem; }
            .zikir-card > i { font-size: 2.5rem; }
            .zikir-card h4 { font-size: 1.2rem; }
            .shortcut-grid { grid-template-columns: repeat(auto-fit, minmax(90px, 1fr)); }
            .survey-button { font-size: 1rem; }
            .settings-item { flex-direction: column; align-items: flex-start; gap: 0.8rem; padding: 1rem 1.2rem; }
            .mode-toggle-container { width: 100%; justify-content: space-between; }
        }
    </style>
</head>
<body>
    <div class="top-bar">
        <button class="icon-btn menu-icon-btn" id="openSidebarBtn" aria-label="Buka Menu">
            <i class="fas fa-bars" aria-hidden="true"></i>
        </button>
        <div class="top-bar-title">ZikirNur</div>
    </div>
    <div id="mySidebar" class="sidebar">
        <div class="header-title">Menu Navigasi</div>
        <ul class="sidebar-nav-list">
            <li><a href="#dashboard" class="nav-link"><i class="fas fa-home" aria-hidden="true"></i> Beranda</a></li>
            <li><a href="#penjelasan" class="nav-link"><i class="fas fa-book-open" aria-hidden="true"></i> Penjelasan Zikir</a></li>
            <li><a href="#pengaturan" class="nav-link"><i class="fas fa-cog" aria-hidden="true"></i> Pengaturan</a></li>
        </ul>
    </div>
    <div class="overlay" id="sidebarOverlay"></div>
    <main>
        <section id="dashboard-section" class="content-section active">
            <div class="dashboard-header">
                <div>
                    <h3>Dzikir Pagi Petang</h3>
                    <p>Sesuai Sunnah</p>
                </div>
                <div class="icon-group">
                     <button class="icon-btn info-icon-btn" aria-label="Informasi Aplikasi">
                         <i class="fas fa-info-circle" aria-hidden="true"></i>
                    </button>
                     <button class="icon-btn moon-icon-btn" id="darkModeIcon" aria-label="Ganti Mode Tampilan">
                         <i class="fas fa-moon" aria-hidden="true"></i>
                    </button>
                </div>
            </div>
            <div class="prayer-time-card">
                <p class="card-location">Medan, Sumatera Utara</p>
                <p class="card-date" id="currentDateHijri" lang="ar"></p>
                <div class="prayer-times-grid" id="prayerTimesGrid">
                    <div class="prayer-time-item"><span>Imsak</span><strong id="time-Imsak">--:--</strong></div>
                    <div class="prayer-time-item"><span>Subuh</span><strong id="time-Fajr">--:--</strong></div>
                    <div class="prayer-time-item"><span>Dzuhur</span><strong id="time-Dhuhr">--:--</strong></div>
                    <div class="prayer-time-item"><span>Ashar</span><strong id="time-Asr">--:--</strong></div>
                    <div class="prayer-time-item"><span>Maghrib</span><strong id="time-Maghrib">--:--</strong></div>
                    <div class="prayer-time-item"><span>Isya</span><strong id="time-Isha">--:--</strong></div>
                </div>
            </div>

            <div class="featured-zikir-container">
                <div class="zikir-card pagi">
                    <audio id="audio-pagi" src="https://raw.githubusercontent.com/AnnurIslamic/ZikirNur2/main/audio/zikir-pagi.mp3"></audio>
                    <i class="fas fa-sun" aria-hidden="true"></i>
                    <h4>Dzikir Pagi</h4>
                    <p class="subtitle">Ba'da Subuh</p>
                    
                    <div class="audio-controls-container">
                        <button class="audio-btn play-btn" data-target="audio-pagi" aria-label="Putar audio zikir pagi"><i class="fas fa-play" aria-hidden="true"></i></button>
                        <button class="audio-btn pause-btn hidden" data-target="audio-pagi" aria-label="Jeda audio zikir pagi"><i class="fas fa-pause" aria-hidden="true"></i></button>
                        <button class="audio-btn stop-btn hidden" data-target="audio-pagi" aria-label="Hentikan audio zikir pagi"><i class="fas fa-stop" aria-hidden="true"></i></button>
                    </div>
                </div>
                <div class="zikir-card petang">
                    <audio id="audio-petang" src="https://raw.githubusercontent.com/AnnurIslamic/ZikirNur2/main/audio/zikir-petang.mp3"></audio>
                    <i class="fas fa-moon" aria-hidden="true"></i>
                    <h4>Dzikir Petang</h4>
                    <p class="subtitle">Ba'da Ashar</p>
                        
                    <div class="audio-controls-container">
                        <button class="audio-btn play-btn" data-target="audio-petang" aria-label="Putar audio zikir petang"><i class="fas fa-play" aria-hidden="true"></i></button>
                        <button class="audio-btn pause-btn hidden" data-target="audio-petang" aria-label="Jeda audio zikir petang"><i class="fas fa-pause" aria-hidden="true"></i></button>
                        <button class="audio-btn stop-btn hidden" data-target="audio-petang" aria-label="Hentikan audio zikir petang"><i class="fas fa-stop" aria-hidden="true"></i></button>
                    </div>
                </div>
            </div>
            
            <div class="shortcut-grid">
                <a href="#dzikir-bada-sholat" class="shortcut-item"><i class="fas fa-hand-holding-heart shortcut-icon" aria-hidden="true"></i><span>Dzikir Ba'da Sholat</span></a>
                <a href="#tata-cara-sholat" class="shortcut-item"><i class="fas fa-mosque shortcut-icon" aria-hidden="true"></i><span>Tata Cara Sholat</span></a>
                <a href="#doa-nabi" class="shortcut-item"><i class="fas fa-book-reader shortcut-icon" aria-hidden="true"></i><span>Doa Para Nabi</span></a>
                <a href="#kiblat" class="shortcut-item"><i class="fas fa-compass shortcut-icon" aria-hidden="true"></i><span>Arah Kiblat</span></a>
                <a href="#doa-harian" class="shortcut-item"><i class="fas fa-hands-praying shortcut-icon" aria-hidden="true"></i><span>Doa Harian</span></a>
                <a href="#tasbih-digital" class="shortcut-item"><i class="fas fa-calculator shortcut-icon" aria-hidden="true"></i><span>Tasbih Digital</span></a>
            </div>
            <a href="#" class="survey-button"><i class="fas fa-clipboard-list" aria-hidden="true"></i> ISI SURVEY YUK</a>
        </section>

        <section id="penjelasan-section" class="content-section">
            <h2>Mengenal Zikir</h2>
            <div class="explanation-container">
                <p>Zikir (bahasa Arab: ذِكْر) secara harfiah berarti mengingat, menyebut, atau mengenang. Dalam konteks Islam, zikir adalah aktivitas mengingat Allah SWT dengan mengucapkan kalimat-kalimat suci dan nama-nama-Nya.</p>
                <p>Zikir dapat dilakukan kapan saja dan di mana saja, baik secara lisan maupun dalam hati. Amalan ini memiliki banyak manfaat, antara lain menenangkan hati, menghapus dosa, dan meningkatkan kedekatan seorang hamba dengan Tuhannya.</p>
                <p>Rasulullah SAW bersabda, "Tiada suatu amalan pun yang lebih menyelamatkan dari azab Allah daripada zikir kepada Allah." (HR. Ahmad dan Tirmidzi).</p>
                <p>Dengan rutin berzikir, seorang muslim akan senantiasa merasakan kehadiran Allah, menemukan ketenangan jiwa, dan memperkuat keimanannya. Ini adalah salah satu bentuk ibadah yang paling mudah namun memiliki ganjaran yang besar di sisi Allah.</p>
            </div>
        </section>
        <section id="pengaturan-section" class="content-section">
            <h2>Pengaturan Aplikasi</h2>
            <div class="settings-container">
                <h4 class="settings-list-title">Tampilan</h4>
                <ul class="settings-list">
                    <li class="settings-item">
                        <div class="setting-label">Mode Otomatis</div>
                        <label class="switch"><input type="checkbox" id="auto-mode-toggle"><span class="slider"></span></label>
                    </li>
                    <li class="settings-item">
                        <div class="setting-label">Mode Malam Manual</div>
                        <label class="switch"><input type="checkbox" id="dark-mode-toggle"><span class="slider"></span></label>
                    </li>
                </ul>
                 <h4 class="settings-list-title">Notifikasi & Izin</h4>
                <ul class="settings-list">
                    <li class="settings-item">
                        <div class="setting-label">Akses Lokasi Otomatis</div>
                        <label class="switch"><input type="checkbox" id="location-access-toggle"><span class="slider"></span></label>
                    </li>
                    <li class="settings-item">
                        <div class="setting-label">Notifikasi Adzan</div>
                        <label class="switch"><input type="checkbox" id="notification-toggle"><span class="slider"></span></label>
                    </li>
                    <li class="settings-item">
                        <div class="setting-label">Suara Notifikasi</div>
                        <label class="switch"><input type="checkbox" id="sound-toggle"><span class="slider"></span></label>
                    </li>
                </ul>
                <h4 class="settings-list-title">Informasi</h4>
                <ul class="settings-list">
                    <li class="settings-item"><a href="#"><div class="setting-label">Kebijakan Privasi</div><i class="fas fa-chevron-right chevron-icon" aria-hidden="true"></i></a></li>
                    <li class="settings-item"><a href="#"><div class="setting-label">Ketentuan Penggunaan</div><i class="fas fa-chevron-right chevron-icon" aria-hidden="true"></i></a></li>
                    <li class="settings-item"><a href="#"><div class="setting-label">Saran & Masukan</div><i class="fas fa-chevron-right chevron-icon" aria-hidden="true"></i></a></li>
                    <li class="settings-item"><div class="setting-label">Versi Aplikasi</div><div class="setting-value">v1.2.0 (27)</div></li>
                </ul>
            </div>
            <a href="#" class="store-button"><i class="fab fa-google-play" aria-hidden="true"></i> Unduh di Google PlayStore</a>
        </section>
    </main>
    <footer>
        <p>&copy; 2025 ZikirNur</p>
    </footer>

    <div id="permission-popup" class="popup-overlay">
        <div class="popup-content">
            <div id="popup-icon-container" class="popup-icon"></div>
            <h3 id="popup-title" class="popup-title"></h3>
            <p id="popup-message" class="popup-message"></p>
            <div class="popup-actions">
                <button id="popup-deny-btn" class="popup-btn secondary">Tolak</button>
                <button id="popup-allow-btn" class="popup-btn primary">Izinkan</button>
            </div>
        </div>
    </div>


    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- Elements ---
            const openSidebarBtn = document.getElementById('openSidebarBtn');
            const sidebar = document.getElementById('mySidebar');
            const sidebarOverlay = document.getElementById('sidebarOverlay');
            const navLinks = document.querySelectorAll('.sidebar-nav-list .nav-link');
            const sections = document.querySelectorAll('.content-section');
            const darkModeToggle = document.getElementById('dark-mode-toggle');
            const autoModeToggle = document.getElementById('auto-mode-toggle');
            const darkModeIcon = document.getElementById('darkModeIcon');
            const locationToggle = document.getElementById('location-access-toggle');
            const notificationToggle = document.getElementById('notification-toggle');
            const soundToggle = document.getElementById('sound-toggle');
            const locationDisplay = document.querySelector('.card-location');
            
            // [PENAMBAHAN BARU] Elemen Pop-up
            const popup = document.getElementById('permission-popup');
            const popupIcon = document.getElementById('popup-icon-container');
            const popupTitle = document.getElementById('popup-title');
            const popupMessage = document.getElementById('popup-message');
            const popupAllowBtn = document.getElementById('popup-allow-btn');
            const popupDenyBtn = document.getElementById('popup-deny-btn');

            // --- Sidebar Logic ---
            function openSidebar() {
                sidebar.classList.add('active');
                sidebarOverlay.classList.add('active');
            }
            function closeSidebar() {
                sidebar.classList.remove('active');
                sidebarOverlay.classList.remove('active');
            }
            openSidebarBtn.addEventListener('click', openSidebar);
            sidebarOverlay.addEventListener('click', closeSidebar);

            // --- Navigation Logic ---
            navLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    navLinks.forEach(l => l.classList.remove('current-page'));
                    e.currentTarget.classList.add('current-page');
                    const targetId = e.currentTarget.getAttribute('href').substring(1) + '-section';
                    sections.forEach(section => section.classList.remove('active'));
                    const targetSection = document.getElementById(targetId);
                    if (targetSection) {
                        targetSection.classList.add('active');
                    }
                    closeSidebar();
                    window.scrollTo(0, 0);
                });
            });
            document.querySelector('.sidebar-nav-list a[href="#dashboard"]').classList.add('current-page');
            document.getElementById('dashboard-section').classList.add('active');

            // --- Dark Mode Logic ---
            let autoModeInterval;
            function setMode(isDark) {
                const moonIconBtn = document.getElementById('darkModeIcon');
                if (isDark) {
                    document.body.classList.add('dark-mode');
                    moonIconBtn.classList.add('dark-mode-active');
                } else {
                    document.body.classList.remove('dark-mode');
                    moonIconBtn.classList.remove('dark-mode-active');
                }
            }
            function checkAutoMode() {
                const isNight = new Date().getHours() >= 18 || new Date().getHours() < 6;
                setMode(isNight);
            }
            function applySavedMode() {
                const savedMode = localStorage.getItem('themeMode') || 'auto';
                if (savedMode === 'dark') {
                    setMode(true);
                    darkModeToggle.checked = true;
                    autoModeToggle.checked = false;
                } else if (savedMode === 'light') {
                    setMode(false);
                    darkModeToggle.checked = false;
                    autoModeToggle.checked = false;
                } else {
                    autoModeToggle.checked = true;
                    darkModeToggle.disabled = true;
                    checkAutoMode();
                    autoModeInterval = setInterval(checkAutoMode, 60000);
                }
            }
            darkModeToggle.addEventListener('change', () => {
                localStorage.setItem('themeMode', darkModeToggle.checked ? 'dark' : 'light');
                applySavedMode();
            });
            autoModeToggle.addEventListener('change', () => {
                clearInterval(autoModeInterval);
                if (autoModeToggle.checked) {
                    localStorage.setItem('themeMode', 'auto');
                    darkModeToggle.checked = false;
                    darkModeToggle.disabled = true;
                    checkAutoMode();
                    autoModeInterval = setInterval(checkAutoMode, 60000);
                } else {
                    darkModeToggle.disabled = false;
                    localStorage.setItem('themeMode', 'light');
                }
                applySavedMode();
            });
            darkModeIcon.addEventListener('click', () => {
                const isCurrentlyDark = document.body.classList.contains('dark-mode');
                autoModeToggle.checked = false;
                darkModeToggle.disabled = false;
                darkModeToggle.checked = !isCurrentlyDark;
                localStorage.setItem('themeMode', !isCurrentlyDark ? 'dark' : 'light');
                applySavedMode();
            });
            applySavedMode();

            // --- [MODIFIKASI] Permission Logic dengan Pop-up Kustom ---

            // Fungsi untuk menampilkan pop-up
            function showPermissionPopup({ title, message, iconHtml, onAllow, onDeny }) {
                popupTitle.textContent = title;
                popupMessage.textContent = message;
                popupIcon.innerHTML = iconHtml;

                // Clone dan replace untuk menghapus event listener lama
                const newAllowBtn = popupAllowBtn.cloneNode(true);
                popupAllowBtn.parentNode.replaceChild(newAllowBtn, popupAllowBtn);
                
                const newDenyBtn = popupDenyBtn.cloneNode(true);
                popupDenyBtn.parentNode.replaceChild(newDenyBtn, popupDenyBtn);

                newAllowBtn.addEventListener('click', () => {
                    onAllow();
                    hidePermissionPopup();
                });
                newDenyBtn.addEventListener('click', () => {
                    onDeny();
                    hidePermissionPopup();
                });

                popup.classList.add('active');
            }
            // Fungsi untuk menyembunyikan pop-up
            function hidePermissionPopup() {
                popup.classList.remove('active');
            }


            locationToggle.addEventListener('change', (e) => {
                if (e.target.checked) {
                    e.preventDefault(); // Mencegah toggle langsung aktif
                    showPermissionPopup({
                        title: 'Izin Lokasi',
                        message: 'ZikirNur memerlukan akses lokasi Anda untuk menampilkan waktu sholat yang akurat di wilayah Anda. Data lokasi tidak akan dibagikan.',
                        iconHtml: '<i class="fas fa-map-marker-alt"></i>',
                        onAllow: () => {
                           locationToggle.checked = true; // Aktifkan toggle
                           requestLocationAccess();
                        },
                        onDeny: () => {
                           locationToggle.checked = false; // Batalkan aktivasi
                        }
                    });
                } else {
                     localStorage.removeItem('userLocation');
                     localStorage.setItem('locationAccess', 'denied');
                     locationDisplay.textContent = 'Medan, Sumatera Utara';
                     fetchPrayerTimes(); // Kembali ke default
                }
            });

            notificationToggle.addEventListener('change', (e) => {
                if (e.target.checked) {
                    e.preventDefault();
                    showPermissionPopup({
                        title: 'Izin Notifikasi',
                        message: 'Izinkan notifikasi agar kami dapat mengingatkan Anda saat waktu sholat tiba (adzan). Anda juga dapat mengaktifkan suara notifikasi setelah ini.',
                        iconHtml: '<i class="fas fa-bell"></i>',
                        onAllow: () => {
                            notificationToggle.checked = true;
                            requestNotificationPermission();
                        },
                        onDeny: () => {
                            notificationToggle.checked = false;
                        }
                    });
                } else {
                     localStorage.setItem('notificationPermission', 'denied');
                     soundToggle.checked = false;
                     soundToggle.disabled = true;
                     localStorage.setItem('soundPermission', 'denied');
                }
            });

            soundToggle.addEventListener('change', () => {
                localStorage.setItem('soundPermission', soundToggle.checked ? 'granted' : 'denied');
            });
            
            function requestLocationAccess() {
                if ('geolocation' in navigator) {
                    locationDisplay.textContent = 'Mendapatkan lokasi...';
                    navigator.geolocation.getCurrentPosition(
                        position => {
                            const { latitude, longitude } = position.coords;
                            localStorage.setItem('userLocation', JSON.stringify({ latitude, longitude }));
                            localStorage.setItem('locationAccess', 'granted');
                            fetchCityName(latitude, longitude);
                            fetchPrayerTimes(latitude, longitude);
                        },
                        error => {
                            console.error("Error getting location:", error);
                            locationToggle.checked = false;
                            localStorage.setItem('locationAccess', 'denied');
                            locationDisplay.textContent = 'Medan, Sumatera Utara';
                        }
                    );
                } else {
                    alert('Geolocation tidak didukung oleh browser Anda.');
                    locationToggle.checked = false;
                }
            }

            async function fetchCityName(lat, lon) {
                try {
                    const response = await fetch(`https://api.bigdatacloud.net/data/reverse-geocode-client?latitude=${lat}&longitude=${lon}&localityLanguage=id`);
                    if (!response.ok) throw new Error('Failed to fetch city name');
                    const data = await response.json();
                    const city = data.city || data.locality || 'Lokasi Anda';
                    const province = data.principalSubdivision || '';
                    locationDisplay.textContent = `${city}, ${province}`;
                } catch (error) {
                    console.error("Gagal mendapatkan nama kota:", error);
                    locationDisplay.textContent = 'Lokasi Anda';
                }
            }

            function requestNotificationPermission() {
                if ('Notification' in window) {
                    Notification.requestPermission().then(permission => {
                        if (permission === 'granted') {
                            localStorage.setItem('notificationPermission', 'granted');
                            soundToggle.disabled = false;
                            new Notification('ZikirNur', {
                                body: 'Terima kasih! Notifikasi adzan telah diaktifkan.',
                                icon: 'https://cdn-icons-png.flaticon.com/512/3090/3090147.png' // Example icon
                            });
                        } else {
                            notificationToggle.checked = false;
                            soundToggle.disabled = true;
                            localStorage.setItem('notificationPermission', 'denied');
                        }
                    });
                } else {
                    alert('Notifikasi tidak didukung oleh browser ini.');
                    notificationToggle.checked = false;
                }
            }

            function initializePermissions() {
                // Location
                if (localStorage.getItem('locationAccess') === 'granted') {
                    locationToggle.checked = true;
                    const savedLocation = JSON.parse(localStorage.getItem('userLocation'));
                    if (savedLocation) {
                        fetchCityName(savedLocation.latitude, savedLocation.longitude);
                        fetchPrayerTimes(savedLocation.latitude, savedLocation.longitude);
                    }
                } else {
                    locationToggle.checked = false;
                    fetchPrayerTimes(); // Fetch default
                }
                // Notifications
                if (localStorage.getItem('notificationPermission') === 'granted' && Notification.permission === 'granted') {
                    notificationToggle.checked = true;
                    soundToggle.disabled = false;
                    soundToggle.checked = (localStorage.getItem('soundPermission') === 'granted');
                } else {
                    notificationToggle.checked = false;
                    soundToggle.disabled = true;
                    soundToggle.checked = false;
                }
            }

            // --- Prayer Times API ---
            async function fetchPrayerTimes(lat = null, lon = null) {
                const ADJUSTMENT = 2;
                let apiUrl;
                if (lat && lon) {
                    apiUrl = `https://api.aladhan.com/v1/timings?latitude=${lat}&longitude=${lon}&method=11`;
                } else {
                    apiUrl = `https://api.aladhan.com/v1/timingsByCity?city=Medan&country=Indonesia&method=11`;
                }
                
                try {
                    const response = await fetch(apiUrl);
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    const data = await response.json();
                    if (data.code === 200) {
                        const times = data.data.timings;
                        function adjustTime(timeStr, minutes) {
                            let [h, m] = timeStr.split(':').map(Number);
                            let date = new Date();
                            date.setHours(h, m + minutes, 0);
                            return `${String(date.getHours()).padStart(2, '0')}:${String(date.getMinutes()).padStart(2, '0')}`;
                        }
                        document.getElementById('time-Imsak').textContent = adjustTime(times.Imsak, ADJUSTMENT);
                        document.getElementById('time-Fajr').textContent = adjustTime(times.Fajr, ADJUSTMENT);
                        document.getElementById('time-Dhuhr').textContent = times.Dhuhr;
                        document.getElementById('time-Asr').textContent = times.Asr;
                        document.getElementById('time-Maghrib').textContent = times.Maghrib;
                        document.getElementById('time-Isha').textContent = adjustTime(times.Isha, ADJUSTMENT);

                        const hijri = data.data.date.hijri;
                        document.getElementById('currentDateHijri').textContent = `${hijri.weekday.ar}, ${hijri.day} ${hijri.month.ar} ${hijri.year} H`;
                        highlightNextPrayer();
                    }
                } catch (error) {
                    console.error("Gagal mengambil data waktu sholat:", error);
                    const prayerGrid = document.getElementById('prayerTimesGrid');
                    if(prayerGrid) {
                        prayerGrid.innerHTML = `<p style="color: white; grid-column: 1 / -1; text-align: center;">Gagal memuat waktu sholat.</p>`;
                    }
                }
            }
            function highlightNextPrayer() {
                const now = new Date();
                const currentTime = now.getHours() * 60 + now.getMinutes();
                const prayerOrder = ['Fajr', 'Dhuhr', 'Asr', 'Maghrib', 'Isha'];
                let nextPrayerFound = false;
                document.querySelectorAll('.prayer-time-item').forEach(item => item.classList.remove('next-prayer'));
                for (const prayer of prayerOrder) {
                    const timeEl = document.getElementById(`time-${prayer}`);
                    if (!timeEl) continue;
                    const timeStr = timeEl.textContent;
                    if (timeStr === '--:--') continue;
                    const [h, m] = timeStr.split(':').map(Number);
                    const prayerTime = h * 60 + m;
                    if (currentTime < prayerTime) {
                        timeEl.closest('.prayer-time-item').classList.add('next-prayer');
                        nextPrayerFound = true;
                        break;
                    }
                }
                if (!nextPrayerFound) {
                     const fajrItem = document.getElementById('time-Fajr');
                     if(fajrItem) fajrItem.closest('.prayer-time-item').classList.add('next-prayer');
                }
            }

            initializePermissions();
            setInterval(highlightNextPrayer, 30000);

            // --- Logika Audio Player ---
            const allAudios = document.querySelectorAll('audio');
            const audioContainer = document.querySelector('.featured-zikir-container');

            function stopAllAudios(exceptAudio) {
                allAudios.forEach(audio => {
                    if (audio !== exceptAudio) {
                        audio.pause();
                        audio.currentTime = 0;
                    }
                });
            }

            function resetAllPlayersUI(exceptContainer) {
                document.querySelectorAll('.audio-controls-container').forEach(container => {
                    if (container !== exceptContainer) {
                        container.querySelector('.play-btn').classList.remove('hidden');
                        container.querySelector('.pause-btn').classList.add('hidden');
                        container.querySelector('.stop-btn').classList.add('hidden');
                    }
                });
            }

            audioContainer.addEventListener('click', (e) => {
                const playBtn = e.target.closest('.play-btn');
                const pauseBtn = e.target.closest('.pause-btn');
                const stopBtn = e.target.closest('.stop-btn');
                
                if (playBtn) {
                    const targetId = playBtn.dataset.target;
                    const audio = document.getElementById(targetId);
                    const container = playBtn.parentElement;

                    stopAllAudios(audio);
                    resetAllPlayersUI(container);

                    audio.play();
                    playBtn.classList.add('hidden');
                    container.querySelector('.pause-btn').classList.remove('hidden');
                    container.querySelector('.stop-btn').classList.remove('hidden');
                }

                if (pauseBtn) {
                    const targetId = pauseBtn.dataset.target;
                    const audio = document.getElementById(targetId);
                    const container = pauseBtn.parentElement;
                    
                    audio.pause();
                    pauseBtn.classList.add('hidden');
                    container.querySelector('.play-btn').classList.remove('hidden');
                }
                
                if (stopBtn) {
                    const targetId = stopBtn.dataset.target;
                    const audio = document.getElementById(targetId);
                    const container = stopBtn.parentElement;
                    
                    audio.pause();
                    audio.currentTime = 0;
                    stopBtn.classList.add('hidden');
                    container.querySelector('.pause-btn').classList.add('hidden');
                    container.querySelector('.play-btn').classList.remove('hidden');
                }
            });
            
            allAudios.forEach(audio => {
                audio.addEventListener('ended', () => {
                    const container = document.querySelector(`.play-btn[data-target="${audio.id}"]`).parentElement;
                    container.querySelector('.play-btn').classList.remove('hidden');
                    container.querySelector('.pause-btn').classList.add('hidden');
                    container.querySelector('.stop-btn').classList.add('hidden');
                });
            });
        });
    </script>
</body>
                                                                                                                                   </html>
